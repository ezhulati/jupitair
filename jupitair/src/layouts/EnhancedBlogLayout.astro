---
import BaseLayout from './BaseLayout.astro';
import Card from '../components/ui/Card.astro';
import Button from '../components/ui/Button.astro';
import Badge from '../components/ui/Badge.astro';
import PhoneLink from '../components/ui/PhoneLink.astro';
import { Image } from 'astro:assets';

export interface Props {
  frontmatter: {
    title: string;
    description: string;
    author: string;
    publishDate: Date;
    updateDate?: Date;
    heroImage?: string;
    heroImageAlt?: string;
    category: string;
    subcategory?: string;
    tags: string[];
    featured: boolean;
    metaTitle?: string;
    metaDescription?: string;
    primaryKeyword: string;
    secondaryKeywords: string[];
    canonicalURL?: string;
    readingTime?: number;
    tableOfContents?: boolean;
    schemaTypes?: string[];
    ctaText?: string;
    ctaLink?: string;
    relatedPosts?: string[];
    internalLinks?: string[];
    expertReviewer?: string;
    reviewDate?: Date;
    technicalDifficulty?: 'beginner' | 'intermediate' | 'advanced';
    costRange?: string;
    timeEstimate?: string;
    tools?: string[];
    seasonalRelevance?: string[];
  };
}

const { frontmatter } = Astro.props;
const formattedPublishDate = new Date(frontmatter.publishDate).toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric'
});
const formattedUpdateDate = frontmatter.updateDate ? new Date(frontmatter.updateDate).toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric'
}) : null;

// Generate breadcrumb data
const breadcrumbs = [
  { name: 'Home', url: '/' },
  { name: 'HVAC Learning Center', url: '/blog' },
  { name: frontmatter.category, url: `/blog/category/${frontmatter.category.toLowerCase().replace(/\s+/g, '-')}` },
  { name: frontmatter.title, url: '#' }
];

// Enhanced Schema with HowTo and FAQ
const blogSchema = {
  "@context": "https://schema.org",
  "@type": "Article",
  "@id": frontmatter.canonicalURL || `https://jupitairhvac.com/blog/${frontmatter.title.toLowerCase().replace(/\s+/g, '-')}`,
  "headline": frontmatter.title,
  "description": frontmatter.description,
  "image": frontmatter.heroImage ? `https://jupitairhvac.com${frontmatter.heroImage}` : "https://jupitairhvac.com/images/default-hvac-blog.jpg",
  "author": {
    "@type": "Organization",
    "name": "Jupitair HVAC",
    "url": "https://jupitairhvac.com",
    "logo": {
      "@type": "ImageObject",
      "url": "https://jupitairhvac.com/logo.png"
    },
    "contactPoint": {
      "@type": "ContactPoint",
      "telephone": "+1-940-390-5676",
      "contactType": "customer service",
      "areaServed": ["Plano", "Frisco", "McKinney", "Allen", "The Colony", "Little Elm", "Prosper", "Addison"],
      "availableLanguage": "English"
    }
  },
  "datePublished": frontmatter.publishDate,
  "dateModified": frontmatter.updateDate || frontmatter.publishDate,
  "publisher": {
    "@type": "Organization",
    "name": "Jupitair HVAC",
    "logo": {
      "@type": "ImageObject",
      "url": "https://jupitairhvac.com/logo.png",
      "width": 600,
      "height": 60
    }
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": frontmatter.canonicalURL || `https://jupitairhvac.com/blog/${frontmatter.title.toLowerCase().replace(/\s+/g, '-')}`
  },
  "keywords": [frontmatter.primaryKeyword, ...frontmatter.secondaryKeywords].join(', '),
  "articleSection": frontmatter.category,
  "wordCount": frontmatter.readingTime ? frontmatter.readingTime * 200 : 800,
  "speakable": {
    "@type": "SpeakableSpecification",
    "cssSelector": [".article-summary", ".key-takeaways"]
  },
  "isPartOf": {
    "@type": "Blog",
    "name": "Jupitair HVAC Learning Center",
    "url": "https://jupitairhvac.com/blog"
  }
};

// Review schema if expert reviewed
const reviewSchema = frontmatter.expertReviewer ? {
  "@context": "https://schema.org",
  "@type": "Review",
  "itemReviewed": {
    "@type": "Article",
    "name": frontmatter.title
  },
  "author": {
    "@type": "Person",
    "name": frontmatter.expertReviewer
  },
  "reviewBody": "This article has been technically reviewed for accuracy",
  "datePublished": frontmatter.reviewDate || frontmatter.updateDate || frontmatter.publishDate
} : null;

// Breadcrumb schema
const breadcrumbSchema = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": breadcrumbs.map((crumb, index) => ({
    "@type": "ListItem",
    "position": index + 1,
    "name": crumb.name,
    "item": crumb.url === '#' ? undefined : `https://jupitairhvac.com${crumb.url}`
  }))
};

// Determine difficulty color
const difficultyColor = {
  'beginner': 'success',
  'intermediate': 'warning',
  'advanced': 'emergency'
}[frontmatter.technicalDifficulty || 'beginner'];
---

<BaseLayout 
  title={frontmatter.metaTitle || `${frontmatter.title} | Jupitair HVAC Expert Guide`}
  description={frontmatter.metaDescription || frontmatter.description}
  keywords={[frontmatter.primaryKeyword, ...frontmatter.secondaryKeywords].join(', ')}
  canonical={frontmatter.canonicalURL}
>
  <!-- Structured Data -->
  <script type="application/ld+json" set:html={JSON.stringify(blogSchema)} />
  <script type="application/ld+json" set:html={JSON.stringify(breadcrumbSchema)} />
  {reviewSchema && (
    <script type="application/ld+json" set:html={JSON.stringify(reviewSchema)} />
  )}

  <!-- MOBILE-FIRST ARTICLE CONTAINER WITH PROPER OVERFLOW CONTROL -->
  <article class="w-full overflow-x-hidden">
    <!-- Mobile-optimized padding: small on mobile, larger on desktop -->
    <div class="px-4 py-6 sm:px-6 md:px-8 lg:max-w-7xl lg:mx-auto lg:py-12">
      
      <!-- BREADCRUMBS - Mobile optimized with horizontal scroll if needed -->
      <nav class="mb-4 sm:mb-6 overflow-x-auto" aria-label="Breadcrumb">
        <ol class="flex items-center gap-1 sm:gap-2 text-xs sm:text-sm whitespace-nowrap">
          {breadcrumbs.map((crumb, index) => (
            <>
              {index > 0 && <span class="text-gray-400" aria-hidden="true">›</span>}
              {crumb.url === '#' ? (
                <li class="text-gray-600 font-medium truncate max-w-[120px] sm:max-w-[200px]" title={crumb.name}>
                  {crumb.name}
                </li>
              ) : (
                <li>
                  <a 
                    href={crumb.url} 
                    class="text-primary-600 hover:text-primary-700 hover:underline transition-colors"
                    aria-label={`Navigate to ${crumb.name}`}
                  >
                    {crumb.name}
                  </a>
                </li>
              )}
            </>
          ))}
        </ol>
      </nav>

      <!-- ARTICLE HEADER -->
      <header class="mb-6 sm:mb-8 lg:mb-12">
        <!-- Category Badges - Wrap on mobile -->
        <div class="flex flex-wrap gap-1.5 sm:gap-2 mb-3 sm:mb-4">
          <Badge variant="primary">{frontmatter.category}</Badge>
          {frontmatter.subcategory && (
            <Badge variant="secondary">{frontmatter.subcategory}</Badge>
          )}
          {frontmatter.featured && (
            <Badge variant="emergency">Featured</Badge>
          )}
          {frontmatter.technicalDifficulty && (
            <Badge variant={difficultyColor as any}>
              {frontmatter.technicalDifficulty}
            </Badge>
          )}
        </div>
        
        <!-- Title - Responsive sizing -->
        <h1 class="text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-bold text-gray-900 mb-3 sm:mb-4 leading-tight">
          {frontmatter.title}
        </h1>
        
        <!-- Description - Responsive text size -->
        <p class="text-base sm:text-lg md:text-xl text-gray-700 mb-4 sm:mb-6 leading-relaxed article-summary">
          {frontmatter.description}
        </p>
        
        <!-- Meta Information - Stack on mobile -->
        <div class="flex flex-col sm:flex-row sm:flex-wrap gap-2 sm:gap-x-4 sm:gap-y-2 text-xs sm:text-sm text-gray-600 border-t border-b border-gray-200 py-3 sm:py-4">
          <!-- Author -->
          <div class="flex items-center gap-1.5 sm:gap-2">
            <svg class="w-3.5 h-3.5 sm:w-4 sm:h-4" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
              <path d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z"/>
            </svg>
            <span>By <strong>{frontmatter.author}</strong></span>
          </div>
          
          <!-- Publish Date -->
          <div class="flex items-center gap-1.5 sm:gap-2">
            <svg class="w-3.5 h-3.5 sm:w-4 sm:h-4" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
              <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"/>
            </svg>
            <time datetime={frontmatter.publishDate.toISOString()}>
              {formattedPublishDate}
            </time>
          </div>
          
          <!-- Reading Time -->
          {frontmatter.readingTime && (
            <div class="flex items-center gap-1.5 sm:gap-2">
              <svg class="w-3.5 h-3.5 sm:w-4 sm:h-4" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"/>
              </svg>
              <span>{frontmatter.readingTime} min read</span>
            </div>
          )}
        </div>

        <!-- Quick Info Cards - Stack on mobile -->
        {(frontmatter.costRange || frontmatter.timeEstimate || frontmatter.tools) && (
          <div class="grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4 mt-4 sm:mt-6">
            {frontmatter.costRange && (
              <Card variant="outline" size="sm" class="text-center py-3">
                <div class="text-gray-600 text-xs sm:text-sm mb-1">Est. Cost</div>
                <div class="text-base sm:text-lg font-bold text-gray-900">{frontmatter.costRange}</div>
              </Card>
            )}
            {frontmatter.timeEstimate && (
              <Card variant="outline" size="sm" class="text-center py-3">
                <div class="text-gray-600 text-xs sm:text-sm mb-1">Time</div>
                <div class="text-base sm:text-lg font-bold text-gray-900">{frontmatter.timeEstimate}</div>
              </Card>
            )}
            {frontmatter.tools && frontmatter.tools.length > 0 && (
              <Card variant="outline" size="sm" class="text-center py-3">
                <div class="text-gray-600 text-xs sm:text-sm mb-1">Tools</div>
                <div class="text-base sm:text-lg font-bold text-gray-900">{frontmatter.tools.length} items</div>
              </Card>
            )}
          </div>
        )}
      </header>

      <!-- Hero Image - Full width on mobile -->
      {frontmatter.heroImage && (
        <div class="mb-6 sm:mb-8 lg:mb-12 -mx-4 sm:mx-0 sm:rounded-xl lg:rounded-2xl overflow-hidden shadow-lg bg-gray-100">
          <img 
            src={frontmatter.heroImage} 
            alt={frontmatter.heroImageAlt || frontmatter.title}
            class="w-full h-auto object-cover"
            loading="eager"
            width="1200"
            height="630"
          />
        </div>
      )}

      <!-- Mobile-First Emergency CTA (shown at top on mobile) -->
      <div class="block lg:hidden mb-6">
        <Card variant="elevated" size="lg" class="bg-gradient-to-br from-emergency-50 to-white border-emergency-200">
          <div class="text-center py-2">
            <h3 class="text-lg font-bold text-gray-900 mb-2">Need Emergency Service?</h3>
            <p class="text-sm text-gray-700 mb-3">24/7 HVAC service available</p>
            <PhoneLink 
              variant="premium"
              size="md" 
              emergency={true}
              class="w-full justify-center"
              context="blog"
            />
          </div>
        </Card>
      </div>

      <!-- Main Content Grid - Stack on mobile, side-by-side on desktop -->
      <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 lg:gap-12">
        
        <!-- Article Content - Full width on mobile -->
        <div class="lg:col-span-8">
          <!-- MOBILE-OPTIMIZED PROSE STYLES WITH OVERFLOW CONTROL -->
          <div class="prose prose-sm sm:prose-base lg:prose-lg max-w-none overflow-x-hidden
            prose-headings:font-bold prose-headings:text-gray-900 prose-headings:break-words
            prose-h2:text-xl sm:prose-h2:text-2xl lg:prose-h2:text-3xl prose-h2:mt-6 sm:prose-h2:mt-8 prose-h2:mb-3 sm:prose-h2:mb-4 prose-h2:border-b prose-h2:border-gray-200 prose-h2:pb-2
            prose-h3:text-lg sm:prose-h3:text-xl lg:prose-h3:text-2xl prose-h3:mt-4 sm:prose-h3:mt-6 prose-h3:mb-2 sm:prose-h3:mb-3 
            prose-h4:text-base sm:prose-h4:text-lg lg:prose-h4:text-xl prose-h4:mt-3 sm:prose-h4:mt-4 prose-h4:mb-2
            prose-p:text-gray-700 prose-p:leading-relaxed prose-p:mb-3 sm:prose-p:mb-4 prose-p:break-words
            prose-a:text-primary-600 hover:prose-a:text-primary-700 prose-a:underline prose-a:font-medium prose-a:break-words
            prose-strong:text-gray-900 prose-strong:font-semibold
            prose-ul:my-3 sm:prose-ul:my-4 prose-ol:my-3 sm:prose-ol:my-4 
            prose-li:my-1 prose-li:text-gray-700 prose-li:leading-relaxed prose-li:break-words
            prose-blockquote:border-l-4 prose-blockquote:border-primary-500 prose-blockquote:bg-primary-50 prose-blockquote:pl-3 sm:prose-blockquote:pl-4 prose-blockquote:pr-3 sm:prose-blockquote:pr-4 prose-blockquote:py-2 prose-blockquote:italic prose-blockquote:text-gray-700 prose-blockquote:my-4 sm:prose-blockquote:my-6
            prose-code:bg-gray-100 prose-code:px-1 sm:prose-code:px-2 prose-code:py-0.5 sm:prose-code:py-1 prose-code:rounded prose-code:text-xs sm:prose-code:text-sm prose-code:text-gray-800 prose-code:font-mono prose-code:break-words
            prose-pre:bg-gray-900 prose-pre:text-gray-100 prose-pre:overflow-x-auto prose-pre:rounded-lg prose-pre:p-3 sm:prose-pre:p-4 prose-pre:text-xs sm:prose-pre:text-sm
            prose-table:w-full prose-table:border-collapse prose-table:text-xs sm:prose-table:text-sm prose-table:overflow-x-auto
            prose-th:bg-gray-100 prose-th:text-left prose-th:font-semibold prose-th:p-2 sm:prose-th:p-3 prose-th:border prose-th:border-gray-300
            prose-td:border prose-td:border-gray-300 prose-td:p-2 sm:prose-td:p-3
            prose-img:rounded-lg prose-img:shadow-lg prose-img:mx-auto prose-img:max-w-full">
            <slot />
          </div>

          <!-- Tools Required Section -->
          {frontmatter.tools && frontmatter.tools.length > 0 && (
            <Card variant="outline" size="lg" class="mt-6 sm:mt-8">
              <h3 class="text-lg sm:text-xl font-bold text-gray-900 mb-3 sm:mb-4 flex items-center gap-2">
                <svg class="w-5 h-5 mr-2 sm:w-6 sm:h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                </svg>
                Tools & Equipment
              </h3>
              <ul class="grid grid-cols-1 sm:grid-cols-2 gap-1.5 sm:gap-2">
                {frontmatter.tools.map(tool => (
                  <li class="flex items-start gap-1.5 sm:gap-2 text-sm sm:text-base text-gray-700">
                    <svg class="w-3.5 h-3.5 sm:w-4 sm:h-4 text-primary-600 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
                      <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                    </svg>
                    <span class="break-words">{tool}</span>
                  </li>
                ))}
              </ul>
            </Card>
          )}

          <!-- Tags - Mobile optimized -->
          {frontmatter.tags && frontmatter.tags.length > 0 && (
            <div class="mt-6 sm:mt-8">
              <h3 class="font-bold text-gray-900 mb-2 sm:mb-3 text-base sm:text-lg">Related Topics:</h3>
              <div class="flex flex-wrap gap-1.5 sm:gap-2">
                {frontmatter.tags.map(tag => (
                  <a 
                    href={`/blog/tag/${tag.toLowerCase().replace(/\s+/g, '-')}`}
                    class="inline-flex items-center px-2 sm:px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-xs sm:text-sm hover:bg-gray-200 transition-colors"
                    aria-label={`View articles tagged with ${tag}`}
                  >
                    <svg class="w-3 h-3 mr-2 sm:w-3.5 sm:h-3.5 mr-0.5 sm:mr-1" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
                      <path fill-rule="evenodd" d="M17.707 9.293a1 1 0 010 1.414l-7 7a1 1 0 01-1.414 0l-7-7A.997.997 0 012 10V5a3 3 0 013-3h5c.256 0 .512.098.707.293l7 7zM5 6a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
                    </svg>
                    {tag}
                  </a>
                ))}
              </div>
            </div>
          )}
        </div>

        <!-- Sidebar - Hidden on mobile, shown on desktop -->
        <aside class="hidden lg:block lg:col-span-4">
          <div class="sticky top-24 space-y-6">
            <!-- Emergency CTA -->
            <Card variant="elevated" size="lg" class="bg-gradient-to-br from-emergency-50 to-white border-emergency-200">
              <div class="text-center">
                <div class="inline-flex items-center justify-center w-16 h-16 bg-emergency-100 rounded-full mb-4">
                  <svg class="w-8 h-8 mr-2 text-emergency-600" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
                  </svg>
                </div>
                <h3 class="text-xl font-bold text-gray-900 mb-2">Need Emergency Service?</h3>
                <p class="text-gray-700 mb-4">24/7 emergency HVAC service available</p>
                <PhoneLink 
                  variant="premium"
                  size="lg" 
                  emergency={true}
                  class="w-full justify-center mb-3"
                  context="blog"
                />
                <p class="text-xs text-gray-600">Average response: 45 minutes</p>
              </div>
            </Card>

            <!-- Schedule Service CTA -->
            <Card variant="elevated" size="lg" class="bg-gradient-to-br from-primary-50 to-white">
              <h3 class="text-lg font-bold text-gray-900 mb-3">Schedule Service</h3>
              <p class="text-gray-700 mb-4">Get professional HVAC service from certified technicians</p>
              <div class="space-y-3">
                <Button 
                  href="/schedule" 
                  variant="primary" 
                  size="md" 
                  class="w-full justify-center"
                  ariaLabel="Schedule HVAC service online"
                >
                  Book Online
                </Button>
                <Button 
                  href="/contact" 
                  variant="outline" 
                  size="md" 
                  class="w-full justify-center"
                  ariaLabel="Get a free HVAC estimate"
                >
                  Get Free Estimate
                </Button>
              </div>
            </Card>

            <!-- Related Posts -->
            {frontmatter.relatedPosts && frontmatter.relatedPosts.length > 0 && (
              <Card variant="default" size="lg">
                <h3 class="text-lg font-bold text-gray-900 mb-4">Related Guides</h3>
                <ul class="space-y-3">
                  {frontmatter.relatedPosts.slice(0, 5).map(post => (
                    <li>
                      <a 
                        href={`/blog/${post}`}
                        class="group flex items-start gap-2 text-primary-600 hover:text-primary-700"
                      >
                        <svg class="w-4 h-4 mr-2 mt-0.5 flex-shrink-0 group-hover:translate-x-1 transition-transform" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
                          <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"/>
                        </svg>
                        <span class="hover:underline">
                          {post.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase())}
                        </span>
                      </a>
                    </li>
                  ))}
                </ul>
              </Card>
            )}
          </div>
        </aside>
      </div>

      <!-- Mobile CTAs and Related Content -->
      <div class="mt-8 sm:mt-12 space-y-6 lg:hidden">
        <!-- Schedule Service CTA - Mobile -->
        <Card variant="elevated" size="lg" class="bg-gradient-to-br from-primary-50 to-white">
          <h3 class="text-lg font-bold text-gray-900 mb-3">Schedule Service</h3>
          <p class="text-sm text-gray-700 mb-4">Professional HVAC service from certified technicians</p>
          <div class="space-y-3">
            <Button 
              href="/schedule" 
              variant="primary" 
              size="md" 
              class="w-full justify-center"
            >
              Book Online
            </Button>
            <Button 
              href="/contact" 
              variant="outline" 
              size="md" 
              class="w-full justify-center"
            >
              Get Free Estimate
            </Button>
          </div>
        </Card>

        <!-- Related Posts - Mobile -->
        {frontmatter.relatedPosts && frontmatter.relatedPosts.length > 0 && (
          <Card variant="default" size="lg">
            <h3 class="text-lg font-bold text-gray-900 mb-3">Related Guides</h3>
            <ul class="space-y-2">
              {frontmatter.relatedPosts.slice(0, 3).map(post => (
                <li>
                  <a 
                    href={`/blog/${post}`}
                    class="flex items-start gap-2 text-sm text-primary-600 hover:text-primary-700"
                  >
                    <svg class="w-3.5 h-3.5 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
                      <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"/>
                    </svg>
                    <span class="hover:underline break-words">
                      {post.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase())}
                    </span>
                  </a>
                </li>
              ))}
            </ul>
          </Card>
        )}
      </div>

      <!-- Bottom CTA - Full width on mobile -->
      <Card variant="elevated" size="lg" class="mt-8 sm:mt-12 bg-gradient-to-br from-primary-50 to-white border-primary-200">
        <div class="text-center px-2 sm:px-4">
          <h2 class="text-xl sm:text-2xl lg:text-3xl font-bold text-gray-900 mb-3 sm:mb-4">
            Ready to Solve Your HVAC Challenges?
          </h2>
          <p class="text-sm sm:text-base lg:text-lg text-gray-700 mb-4 sm:mb-6 max-w-2xl mx-auto">
            Don't let HVAC issues disrupt your comfort. Our experienced technicians are ready to help.
          </p>
          <div class="flex flex-col sm:flex-row gap-3 sm:gap-4 justify-center">
            <PhoneLink 
              variant="premium"
              size="md" 
              class="justify-center"
              context="blog"
            />
            <Button href="/contact" variant="outline" size="md" class="justify-center">
              Get Free Estimate
            </Button>
          </div>
          <p class="text-xs sm:text-sm text-gray-600 mt-4 sm:mt-6">
            ⭐⭐⭐⭐⭐ 4.9/5 based on 500+ Reviews
          </p>
        </div>
      </Card>
    </div>
  </article>

  <!-- Footer Disclaimer -->
  <footer class="px-4 py-6 sm:px-6 sm:py-8 mt-8 sm:mt-12 border-t border-gray-200">
    <div class="max-w-7xl mx-auto">
      <div class="text-xs sm:text-sm text-gray-600 space-y-2">
        <p>
          <strong>Last Updated:</strong> {formattedUpdateDate || formattedPublishDate} | 
          <strong>License:</strong> TACLA #123456
        </p>
        <p class="break-words">
          Jupitair HVAC serves all of North Texas. The information provided is for educational purposes only.
        </p>
      </div>
    </div>
  </footer>

  <!-- Scripts -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Ensure tables are wrapped for mobile scrolling
      const tables = document.querySelectorAll('.prose table');
      tables.forEach(table => {
        if (!table.parentElement.classList.contains('table-wrapper')) {
          const wrapper = document.createElement('div');
          wrapper.className = 'table-wrapper overflow-x-auto -mx-4 sm:mx-0';
          table.parentNode.insertBefore(wrapper, table);
          wrapper.appendChild(table);
        }
      });

      // Ensure code blocks don't break layout
      const codeBlocks = document.querySelectorAll('.prose pre');
      codeBlocks.forEach(block => {
        block.style.maxWidth = '100%';
        block.style.overflowX = 'auto';
      });
    });
  </script>

  <style>
    /* Mobile-first styles to prevent text overflow */
    article {
      word-wrap: break-word;
      overflow-wrap: break-word;
    }

    /* Ensure all content respects container boundaries */
    .prose {
      word-break: break-word;
      overflow-wrap: break-word;
    }

    /* Table wrapper for horizontal scrolling on mobile */
    .table-wrapper {
      -webkit-overflow-scrolling: touch;
    }

    .table-wrapper table {
      min-width: 100%;
    }

    /* Prevent long URLs from breaking layout */
    .prose a {
      word-break: break-all;
    }

    /* Ensure images are responsive */
    .prose img {
      max-width: 100%;
      height: auto;
    }

    /* Mobile-optimized code blocks */
    .prose pre {
      -webkit-overflow-scrolling: touch;
      max-width: 100vw;
    }

    @media (max-width: 640px) {
      .prose pre {
        margin-left: -1rem;
        margin-right: -1rem;
        border-radius: 0;
      }
    }

    /* Ensure lists don't overflow */
    .prose ul, .prose ol {
      padding-left: 1.25rem;
    }

    @media (min-width: 640px) {
      .prose ul, .prose ol {
        padding-left: 1.5rem;
      }
    }
  </style>
</BaseLayout>
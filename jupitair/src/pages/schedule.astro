---
import BaseLayout from '../layouts/BaseLayout.astro';
import Button from '../components/ui/Button.astro';
import Card from '../components/ui/Card.astro';

const pageTitle = "Schedule Service | Jupitair HVAC | Book Online";
const pageDescription = "Schedule your HVAC service online. Choose your preferred date and time for AC repair, heating service, or maintenance in North Texas.";

// Generate time slots
const timeSlots = [
  '08:00 AM', '08:30 AM', '09:00 AM', '09:30 AM', 
  '10:00 AM', '10:30 AM', '11:00 AM', '11:30 AM',
  '01:00 PM', '01:30 PM', '02:00 PM', '02:30 PM',
  '03:00 PM', '03:30 PM', '04:00 PM', '04:30 PM'
];

// Generate next 30 days for calendar
const getDaysInMonth = () => {
  const days = [];
  const today = new Date();
  for (let i = 0; i < 30; i++) {
    const date = new Date(today);
    date.setDate(today.getDate() + i);
    days.push(date);
  }
  return days;
};

const availableDays = getDaysInMonth();
---

<BaseLayout 
  title={pageTitle}
  description={pageDescription}
  canonical="https://jupitairhvac.com/schedule"
>
  <div class="container mx-auto px-4 py-12">
    <!-- Header -->
    <div class="text-center mb-12">
      <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-4">
        Schedule Your Service
      </h1>
      <p class="text-xl text-gray-600 max-w-3xl mx-auto">
        Book your appointment online for HVAC service in North Texas. 
        Same-day service available for emergencies.
      </p>
    </div>

    <div class="grid lg:grid-cols-3 gap-8 max-w-7xl mx-auto">
      <!-- Left Column - Service Selection -->
      <div class="lg:col-span-2">
        <Card variant="elevated" padding="lg">
          <!-- Service Type Selection -->
          <div class="mb-8">
            <h2 class="text-2xl font-semibold text-gray-900 mb-4">
              Select Service Type
            </h2>
            <div class="grid md:grid-cols-2 gap-4">
              <label class="service-option">
                <input type="radio" name="service" value="ac-repair" class="sr-only peer" />
                <div class="p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-primary-500 peer-checked:border-primary-600 peer-checked:bg-primary-50 transition-all">
                  <h3 class="font-semibold text-gray-900">AC Repair</h3>
                  <p class="text-sm text-gray-600">AC not cooling, strange noises, or not working</p>
                </div>
              </label>
              
              <label class="service-option">
                <input type="radio" name="service" value="heating-repair" class="sr-only peer" />
                <div class="p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-primary-500 peer-checked:border-primary-600 peer-checked:bg-primary-50 transition-all">
                  <h3 class="font-semibold text-gray-900">Heating Repair</h3>
                  <p class="text-sm text-gray-600">Furnace or heat pump issues</p>
                </div>
              </label>
              
              <label class="service-option">
                <input type="radio" name="service" value="maintenance" class="sr-only peer" />
                <div class="p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-primary-500 peer-checked:border-primary-600 peer-checked:bg-primary-50 transition-all">
                  <h3 class="font-semibold text-gray-900">Maintenance</h3>
                  <p class="text-sm text-gray-600">Preventive maintenance and tune-ups</p>
                </div>
              </label>
              
              <label class="service-option">
                <input type="radio" name="service" value="installation" class="sr-only peer" />
                <div class="p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-primary-500 peer-checked:border-primary-600 peer-checked:bg-primary-50 transition-all">
                  <h3 class="font-semibold text-gray-900">Installation</h3>
                  <p class="text-sm text-gray-600">New system installation or replacement</p>
                </div>
              </label>
            </div>
          </div>

          <!-- Calendar -->
          <div class="mb-8">
            <h2 class="text-2xl font-semibold text-gray-900 mb-4">
              Select Date
            </h2>
            <div class="grid grid-cols-7 gap-2">
              <!-- Day headers -->
              {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map(day => (
                <div class="text-center text-sm font-medium text-gray-600 py-2">
                  {day}
                </div>
              ))}
              
              <!-- Calendar days -->
              {availableDays.slice(0, 28).map((date, index) => {
                const isToday = date.toDateString() === new Date().toDateString();
                const dayName = date.toLocaleDateString('en-US', { weekday: 'short' });
                const dayNumber = date.getDate();
                const isWeekend = date.getDay() === 0 || date.getDay() === 6;
                
                return (
                  <label class="calendar-day">
                    <input 
                      type="radio" 
                      name="date" 
                      value={date.toISOString()} 
                      class="sr-only peer" 
                    />
                    <div class={`
                      p-3 text-center border rounded-lg cursor-pointer transition-all
                      ${isToday ? 'border-primary-500 font-semibold' : 'border-gray-200'}
                      ${isWeekend ? 'bg-gray-50' : ''}
                      hover:border-primary-400 hover:bg-primary-50
                      peer-checked:bg-primary-600 peer-checked:text-white peer-checked:border-primary-600
                    `}>
                      {dayNumber}
                    </div>
                  </label>
                );
              })}
            </div>
          </div>

          <!-- Time Selection -->
          <div class="mb-8">
            <h2 class="text-2xl font-semibold text-gray-900 mb-4">
              Select Time
            </h2>
            <div class="grid grid-cols-4 md:grid-cols-4 gap-3">
              {timeSlots.map(time => (
                <label class="time-slot">
                  <input type="radio" name="time" value={time} class="sr-only peer" />
                  <div class="p-3 text-center border-2 border-gray-200 rounded-lg cursor-pointer hover:border-primary-500 peer-checked:border-primary-600 peer-checked:bg-primary-600 peer-checked:text-white transition-all">
                    {time}
                  </div>
                </label>
              ))}
            </div>
          </div>
        </Card>
      </div>

      <!-- Right Column - Contact Form -->
      <div>
        <Card variant="elevated" padding="lg" class="sticky top-4">
          <h2 class="text-2xl font-semibold text-gray-900 mb-6">
            Your Information
          </h2>
          
          <form id="booking-form" class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">
                Name *
              </label>
              <input 
                type="text" 
                name="name" 
                required
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                placeholder="John Smith"
              />
            </div>
            
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">
                Phone *
              </label>
              <input 
                type="tel" 
                name="phone" 
                required
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                placeholder="(940) 390-5676"
              />
            </div>
            
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">
                Email *
              </label>
              <input 
                type="email" 
                name="email" 
                required
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                placeholder="john@example.com"
              />
            </div>
            
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">
                Address *
              </label>
              <input 
                type="text" 
                name="address" 
                required
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                placeholder="123 Main St, Frisco, TX 75034"
              />
            </div>
            
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">
                Issue Description
              </label>
              <textarea 
                name="description" 
                rows="3"
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                placeholder="Please describe the issue you're experiencing..."
              ></textarea>
            </div>
            
            <div class="pt-4">
              <Button type="submit" variant="primary" size="lg" class="w-full justify-center">
                Book Appointment
              </Button>
            </div>
            
            <div class="text-center text-sm text-gray-600 pt-2">
              <p>Or call us directly at</p>
              <a href="tel:(940) 390-5676" class="text-primary-600 font-semibold text-lg hover:text-primary-700">
                (940) 390-5676
              </a>
            </div>
          </form>
        </Card>
      </div>
    </div>

    <!-- Emergency Notice -->
    <div class="mt-12 bg-emergency-50 border-2 border-emergency-200 rounded-lg p-6 text-center">
      <h3 class="text-xl font-semibold text-emergency-800 mb-2">
        Need Emergency Service?
      </h3>
      <p class="text-emergency-700 mb-4">
        For urgent HVAC emergencies, please call us directly for immediate assistance.
      </p>
      <Button href="tel:(940) 390-5676" variant="emergency" size="lg" class="inline-flex">
        Call Now: (940) 390-5676
      </Button>
    </div>
  </div>

  <script>
    // Handle form submission
    document.getElementById('booking-form')?.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const formData = new FormData(e.target);
      const service = document.querySelector('input[name="service"]:checked')?.value;
      const date = document.querySelector('input[name="date"]:checked')?.value;
      const time = document.querySelector('input[name="time"]:checked')?.value;
      
      if (!service || !date || !time) {
        alert('Please select a service, date, and time');
        return;
      }
      
      // Add selected options to form data
      formData.append('service', service);
      formData.append('date', new Date(date).toLocaleDateString());
      formData.append('time', time);
      
      // Here you would send to your API endpoint
      console.log('Booking data:', Object.fromEntries(formData));
      
      // Show success message
      alert('Thank you for booking! We will contact you shortly to confirm your appointment.');
    });
  </script>
</BaseLayout>
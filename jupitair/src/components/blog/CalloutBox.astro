---
/**
 * Callout Box Component for Jupitair HVAC Blog
 * Features: Multiple types, accessibility, responsive design
 */

interface Props {
  type?: 'info' | 'warning' | 'danger' | 'success' | 'emergency';
  title?: string;
  icon?: string;
  className?: string;
}

const { type = 'info', title, icon, className = '' } = Astro.props;

// Type-specific configurations
const typeConfig = {
  info: {
    bgColor: 'bg-blue-50',
    borderColor: 'border-blue-200',
    textColor: 'text-blue-800',
    titleColor: 'text-blue-900',
    iconColor: 'text-blue-600',
    defaultIcon: '‚ÑπÔ∏è',
    defaultTitle: 'Information'
  },
  warning: {
    bgColor: 'bg-yellow-50',
    borderColor: 'border-yellow-200',
    textColor: 'text-yellow-800',
    titleColor: 'text-yellow-900',
    iconColor: 'text-yellow-600',
    defaultIcon: '‚ö†Ô∏è',
    defaultTitle: 'Warning'
  },
  danger: {
    bgColor: 'bg-red-50',
    borderColor: 'border-red-200',
    textColor: 'text-red-800',
    titleColor: 'text-red-900',
    iconColor: 'text-red-600',
    defaultIcon: 'üö®',
    defaultTitle: 'Danger'
  },
  success: {
    bgColor: 'bg-green-50',
    borderColor: 'border-green-200',
    textColor: 'text-green-800',
    titleColor: 'text-green-900',
    iconColor: 'text-green-600',
    defaultIcon: '‚úÖ',
    defaultTitle: 'Success'
  },
  emergency: {
    bgColor: 'bg-red-100',
    borderColor: 'border-red-300',
    textColor: 'text-red-900',
    titleColor: 'text-red-900',
    iconColor: 'text-red-700',
    defaultIcon: 'üö®',
    defaultTitle: 'Emergency'
  }
};

const config = typeConfig[type];
const displayIcon = icon || config.defaultIcon;
const displayTitle = title || config.defaultTitle;

// Generate appropriate ARIA role
const ariaRole = type === 'danger' || type === 'emergency' ? 'alert' : 'note';
---

<div 
  class={`callout-box ${config.bgColor} ${config.borderColor} ${config.textColor} border-l-4 rounded-r-lg p-4 my-6 ${className}`}
  role={ariaRole}
  aria-label={`${displayTitle} callout`}
>
  <div class="flex items-start gap-3">
    <!-- Icon -->
    <div class={`flex-shrink-0 ${config.iconColor}`}>
      {displayIcon.startsWith('http') || displayIcon.startsWith('/') ? (
        <img src={displayIcon} alt="" class="w-6 h-6" aria-hidden="true" />
      ) : displayIcon.length === 1 || displayIcon.includes('Ô∏è') ? (
        <span class="text-xl" aria-hidden="true">{displayIcon}</span>
      ) : (
        <!-- SVG icon fallback -->
        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
          {type === 'info' && (
            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
          )}
          {type === 'warning' && (
            <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
          )}
          {(type === 'danger' || type === 'emergency') && (
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
          )}
          {type === 'success' && (
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
          )}
        </svg>
      )}
    </div>

    <!-- Content -->
    <div class="flex-1 min-w-0">
      <!-- Title -->
      <h4 class={`font-semibold ${config.titleColor} mb-2`}>
        {displayTitle}
      </h4>
      
      <!-- Content slot -->
      <div class="prose prose-sm max-w-none">
        <slot />
      </div>
    </div>
  </div>

  <!-- Emergency contact for danger/emergency types -->
  {(type === 'danger' || type === 'emergency') && (
    <div class="mt-4 pt-3 border-t border-red-200">
      <div class="flex flex-col sm:flex-row gap-2 sm:gap-4">
        <a 
          href="tel:9403905676"
          class="inline-flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-semibold text-sm"
        >
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
          </svg>
          Emergency Service: (940) 390-5676
        </a>
        <span class="text-xs text-red-700 self-center">Available 24/7</span>
      </div>
    </div>
  )}
</div>

<style>
  .callout-box {
    position: relative;
    transition: all 0.3s ease;
  }
  
  .callout-box:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }
  
  /* Enhanced emergency styling */
  .callout-box[role="alert"] {
    animation: subtle-pulse 2s ease-in-out infinite;
  }
  
  @keyframes subtle-pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.95; }
  }
  
  /* Print styles */
  @media print {
    .callout-box {
      border: 2px solid #000;
      background: #fff !important;
      color: #000 !important;
      break-inside: avoid;
    }
    
    .callout-box * {
      color: #000 !important;
    }
  }
  
  /* High contrast mode */
  @media (prefers-contrast: high) {
    .callout-box {
      border-width: 3px;
      font-weight: bold;
    }
  }
  
  /* Reduced motion */
  @media (prefers-reduced-motion: reduce) {
    .callout-box {
      transition: none;
      animation: none;
    }
    
    .callout-box:hover {
      transform: none;
    }
  }
</style>
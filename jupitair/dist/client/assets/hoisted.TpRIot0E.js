import"./hoisted.Br07GWtr.js";import"./hoisted.2g7wgElW.js";async function u(i,o){const e=document.getElementById("preferred-time"),a=document.getElementById("time-loading"),t=document.getElementById("availability-message");if(!(!e||!a||!t)){a.classList.remove("hidden"),t.classList.add("hidden"),e.disabled=!0,e.innerHTML='<option value="">Loading available times...</option>';try{const l=new URLSearchParams({date:i,service:o||"general"}),n=await(await fetch(`/api/availability?${l}`)).json();if(a.classList.add("hidden"),n.availableSlots&&n.availableSlots.length>0){e.innerHTML='<option value="">Select preferred time</option>',n.availableSlots.forEach(r=>{const d=document.createElement("option");d.value=r.value,d.textContent=r.label,e.appendChild(d)});const s=document.createElement("option");s.value="anytime",s.textContent="Any available time that day",e.appendChild(s),e.disabled=!1,n.message?(t.textContent=n.message,t.className="mt-2 text-sm text-green-600",t.classList.remove("hidden")):n.businessHours&&(t.textContent=`Business hours: ${n.businessHours}`,t.className="mt-2 text-sm text-gray-600",t.classList.remove("hidden"))}else{e.innerHTML='<option value="">No available times</option>',e.disabled=!0;const s=n.message||"No available time slots for this date.";t.textContent=s,t.className="mt-2 text-sm text-yellow-600",t.classList.remove("hidden"),s.includes("call")&&(t.className="mt-2 text-sm text-emergency-600 font-medium")}}catch(l){console.error("Error checking availability:",l),a.classList.add("hidden"),e.innerHTML=`
          <option value="">Select preferred time</option>
          <option value="8:00 AM - 10:00 AM">8:00 AM - 10:00 AM</option>
          <option value="10:00 AM - 12:00 PM">10:00 AM - 12:00 PM</option>
          <option value="12:00 PM - 2:00 PM">12:00 PM - 2:00 PM</option>
          <option value="2:00 PM - 4:00 PM">2:00 PM - 4:00 PM</option>
          <option value="4:00 PM - 6:00 PM">4:00 PM - 6:00 PM</option>
          <option value="anytime">Any time that day</option>
        `,e.disabled=!1,t.textContent="Unable to check availability. All time slots shown.",t.className="mt-2 text-sm text-gray-600",t.classList.remove("hidden")}}}document.addEventListener("DOMContentLoaded",function(){const i=document.getElementById("preferred-date"),o=document.getElementById("service");i&&i.addEventListener("change",function(){const e=this.value,a=o?.value||"";if(e)u(e,a);else{const t=document.getElementById("preferred-time");t&&(t.innerHTML='<option value="">First select a date to see available times</option>',t.disabled=!0),document.getElementById("availability-message")?.classList.add("hidden")}}),o&&o.addEventListener("change",function(){const e=i?.value;e&&u(e,this.value)})});document.getElementById("contact-form")?.addEventListener("submit",async function(i){i.preventDefault();const o=i.target,e=o.querySelector('button[type="submit"]'),a=new FormData(o),t=Object.fromEntries(a);e.disabled=!0;const l=e.textContent;e.textContent="Sending...";try{const c=await fetch("/api/contact",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),n=await c.json();if(c.ok)window.location.href="/success?type=contact";else if(n.errorCode==="SLOT_UNAVAILABLE")alert("The selected time slot is no longer available. The page will refresh to show current availability."),window.location.reload();else if(n.errorCode==="NO_AVAILABILITY"){alert(n.error||"No available time slots found. Please select a different date.");const s=document.getElementById("preferred-date");if(s){s.value="";const r=document.getElementById("preferred-time");r&&(r.innerHTML='<option value="">First select a date to see available times</option>',r.disabled=!0)}}else alert(n.error||"There was an error submitting your request. Please call us at (940) 390-5676")}catch(c){console.error("Form submission error:",c),alert("Unable to submit form. Please call us directly at (940) 390-5676")}finally{e.disabled=!1,e.textContent=l}});const v=new URLSearchParams(window.location.search),m=v.get("service"),p=v.get("type");if(m){const i=document.getElementById("service");if(i){const e={"ac-repair":"ac-repair","heating-repair":"heating-repair","furnace-repair":"heating-repair","hvac-installation":"hvac-installation","ac-installation":"hvac-installation",maintenance:"maintenance","ac-maintenance":"maintenance","emergency-ac-repair":"emergency","emergency-service":"emergency",commercial:"commercial","restaurant-hvac":"commercial","retail-hvac":"commercial","office-hvac":"commercial"}[m]||"other";if(i.value=e,m.includes("emergency")){const a=document.querySelector('input[name="emergency"]');a&&(a.checked=!0)}if(p==="commercial"){const a=document.getElementById("message");a&&(a.value=`Commercial service requested: ${m.replace(/-/g," ")}`)}}}
